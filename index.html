<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>통합 DA/퍼포먼스 캠페인 심층 분석 대시보드</title>
    <!-- Tailwind CSS CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@100..900&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Inter', sans-serif; background-color: #f7f9fb; }
        .scroll-container::-webkit-scrollbar { height: 8px; }
        .scroll-container::-webkit-scrollbar-thumb { background-color: #cbd5e1; border-radius: 4px; }
        .scroll-container::-webkit-scrollbar-track { background: #f1f5f9; }
        
        /* 4-Quadrant Matrix Styling */
        .quadrant-matrix {
            position: relative;
            width: 100%;
            height: 480px; /* PC 환경에 맞게 높이 확대 */
            display: grid;
            grid-template-columns: 1fr 1fr;
            grid-template-rows: 1fr 1fr;
            border: 2px solid #e5e7eb;
            border-radius: 12px;
            overflow: hidden;
        }

        .quadrant {
            padding: 1rem;
            display: flex;
            flex-direction: column;
            justify-content: flex-start;
            align-items: flex-start;
            position: relative;
            z-index: 10;
        }

        /* Quadrant Colors & Labels for Intuitive Interpretation */
        .quadrant-top-right { background-color: rgba(16, 185, 129, 0.05); border-left: 2px solid #e5e7eb; border-bottom: 2px solid #e5e7eb; } /* Top: Green */
        .quadrant-top-left { background-color: rgba(59, 130, 246, 0.05); border-bottom: 2px solid #e5e7eb; } /* Potential: Blue */
        .quadrant-bottom-right { background-color: rgba(245, 158, 11, 0.05); border-left: 2px solid #e5e7eb; } /* Focus: Amber */
        .quadrant-bottom-left { background-color: rgba(239, 68, 68, 0.05); } /* Low: Red */

        .quadrant-label {
            font-weight: 700;
            font-size: 1.5rem;
            position: absolute;
            opacity: 0.1; /* 배경 레이블로 처리 */
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            pointer-events: none;
            user-select: none;
        }

        .chart-dot {
            position: absolute;
            width: 14px;
            height: 14px;
            border-radius: 50%;
            cursor: pointer;
            z-index: 50;
            transition: transform 0.2s, box-shadow 0.2s;
            border: 2px solid #fff;
            box-shadow: 0 0 8px rgba(0, 0, 0, 0.3);
        }

        .chart-dot:hover {
            transform: scale(1.5);
            z-index: 60;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.5);
        }
    </style>
</head>
<body class="p-6 md:p-12">

    <div id="app" class="max-w-screen-xl mx-auto bg-white rounded-xl shadow-2xl p-8 md:p-12">

        <!-- Header and Campaign Selector -->
        <header class="mb-8 border-b pb-4">
            <h1 class="text-4xl font-extrabold text-gray-900 mb-2">통합 캠페인 성과 심층 분석 대시보드 (PC)</h1>
            <p class="text-gray-500">DA/퍼포먼스 목표별 효율 분석 및 소재 등급별 직관적 인사이트 도출</p>
        </header>

        <!-- Campaign Selector Tabs -->
        <div class="flex space-x-2 p-1 bg-gray-100 rounded-lg max-w-lg mb-8" role="tablist">
            <button id="tab-da" data-camp="DA" class="campaign-tab flex-1 py-3 px-6 text-base font-semibold rounded-lg bg-indigo-600 text-white shadow-lg transition-all">
                DA 캠페인 (반응 목표)
            </button>
            <button id="tab-perf" data-camp="PERF" class="campaign-tab flex-1 py-3 px-6 text-base font-medium text-gray-600 hover:bg-white hover:text-indigo-600 transition-all">
                퍼포먼스 캠페인 (전환 목표)
            </button>
        </div>

        <!-- 1. Overall Performance Summary Table (NEW) -->
        <div class="mb-10">
            <h2 class="text-2xl font-bold text-gray-800 mb-4">종합 성과 요약 <span id="summary-title" class="text-indigo-600 text-lg ml-2"></span></h2>
            <div class="overflow-hidden rounded-xl shadow-lg border">
                <table class="min-w-full divide-y divide-gray-200">
                    <thead class="bg-indigo-50">
                        <tr id="summary-header" class="text-sm font-semibold text-indigo-700 uppercase tracking-wider">
                            <!-- Summary Headers -->
                        </tr>
                    </thead>
                    <tbody id="summary-body" class="bg-white divide-y divide-gray-200">
                        <!-- Summary Data -->
                    </tbody>
                </table>
            </div>
        </div>

        <!-- 2. Visualization and Insights (3-Column Layout) -->
        <div class="grid grid-cols-1 xl:grid-cols-3 gap-10">
            
            <!-- Left 2/3: 4-Quadrant Matrix -->
            <div class="xl:col-span-2 space-y-6">
                <div class="bg-white p-6 rounded-xl shadow-lg border border-gray-200">
                    <h2 class="text-2xl font-bold text-gray-800 mb-4 flex items-center">
                        소재 성과 도식화 (4분면 매트릭스)
                        <span id="chart-axes-label" class="ml-3 text-sm text-gray-500"></span>
                    </h2>
                    
                    <div class="quadrant-matrix" id="quadrant-matrix">
                        <!-- Quadrant 1: Top Right (Top) -->
                        <div class="quadrant quadrant-top-right">
                            <div class="quadrant-label text-green-700">Top Zone</div>
                        </div>
                        <!-- Quadrant 2: Top Left (Potential) -->
                        <div class="quadrant quadrant-top-left">
                            <div class="quadrant-label text-blue-700">Potential Zone</div>
                        </div>
                        <!-- Quadrant 3: Bottom Left (Low) -->
                        <div class="quadrant quadrant-bottom-left">
                            <div class="quadrant-label text-red-700">Low Zone</div>
                        </div>
                        <!-- Quadrant 4: Bottom Right (Focus) -->
                        <div class="quadrant quadrant-bottom-right">
                            <div class="quadrant-label text-amber-700">Focus Zone</div>
                        </div>

                        <!-- Dots are injected here -->
                    </div>
                    
                    <div id="matrix-info" class="mt-4 flex justify-between text-sm text-gray-600 font-medium">
                        <span id="y-low-label"></span>
                        <span id="y-high-label"></span>
                    </div>
                    <p class="text-sm text-gray-500 mt-2 text-center">X축: <span id="x-axis-label" class="font-semibold text-gray-700"></span></p>
                </div>
            </div>

            <!-- Right 1/3: Key Insights -->
            <div class="xl:col-span-1 space-y-6">
                <div class="bg-indigo-50 p-6 rounded-xl shadow-lg border border-indigo-200 h-full">
                    <h2 class="text-2xl font-bold text-indigo-700 mb-4 flex items-center">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 inline-block mr-2" viewBox="0 0 24 24" fill="currentColor"><path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm1 15h-2v-6h2v6zm0-8h-2V7h2v2z"/></svg>
                        매체/등급별 핵심 인사이트
                    </h2>
                    <ul id="insight-list" class="space-y-4 text-gray-700 text-sm">
                        <!-- Insights will be injected here -->
                    </ul>
                </div>
            </div>
        </div>
        
        <!-- 3. Efficiency Data Table -->
        <div class="mt-10">
            <h2 class="text-2xl font-bold text-gray-800 mb-4">캠페인 상세 효율 지표 (소재별)</h2>
            <div class="scroll-container overflow-x-auto rounded-xl shadow-inner border">
                <table class="min-w-full divide-y divide-gray-200">
                    <thead class="bg-gray-100 sticky top-0">
                        <tr id="table-header" class="text-xs font-medium text-gray-500 uppercase tracking-wider">
                            <!-- Headers will be injected here -->
                        </tr>
                    </thead>
                    <tbody id="table-body" class="bg-white divide-y divide-gray-200">
                        <!-- Data rows will be injected here -->
                    </tbody>
                </table>
            </div>
        </div>
    </div>

    <script>
        // Firebase Config (Mandatory for Canvas Environment)
        const appId = typeof __app_id !== 'undefined' ? __app_id : 'default-app-id';
        const firebaseConfig = typeof __firebase_config !== 'undefined' ? JSON.parse(__firebase_config) : {};
        // Note: Firestore is not used in this template as it is a pure visualization tool, but the mandatory variables are kept.

        // Mock data structure including Overall Summary
        const campaignData = {
            'DA': {
                name: 'DA 캠페인 (반응 목표)',
                metrics: { xAxis: '소재 관심도 (B)', yAxis: '유효 노출 기여도 (A)' },
                summary: [
                    { label: '총 광고비', value: 4500000, type: 'currency' },
                    { label: '총 노출수', value: 9500000, type: 'number' },
                    { label: '평균 CPM', value: 473.68, type: 'currency' },
                    { label: '평균 CTR', value: 0.42, type: 'percent' },
                    { label: '평균 CPC', value: 112.5, type: 'currency' },
                ],
                headers: [
                    '매체', '소재 구분', '노출수', '클릭수', '광고비', 'CPM(원)', 'CTR(%)', 'CPC(원)', '노출 기여도(A)', '소재 관심도(B)', '총점', 'INSIGHT', '교체 유무'
                ],
                data: [
                    { media: '네이버 GFA', creative: '소재A_블랙', cost: 1200000, imp: 2500000, click: 12500, cpm: 480, ctr: 0.50, cpc: 96, scoreA: 4.8, scoreB: 4.5, total: 4.65, insight: 'Top 소재', color: '#10b981', mediaInsight: 'GFA Top 소재는 노출과 관심도 모두 높습니다. 예산 집중(확대).' },
                    { media: '카카오 비즈보드', creative: '소재B_레드', cost: 1000000, imp: 2200000, click: 8800, cpm: 454.5, ctr: 0.40, cpc: 113.6, scoreA: 4.0, scoreB: 4.0, total: 4.0, insight: 'Top 소재', color: '#10b981', mediaInsight: '비즈보드 Top 소재는 안정적입니다. A/B 테스트로 관심도(B) 개선 시도.' },
                    { media: '구글 GDN', creative: '소재C_그린', cost: 1500000, imp: 3000000, click: 9000, cpm: 500, ctr: 0.30, cpc: 166.7, scoreA: 3.5, scoreB: 2.0, total: 2.75, insight: 'Focus 소재', color: '#f59e0b', mediaInsight: 'GDN은 노출 효율(A)은 괜찮으나 소재 관심도(B)가 낮습니다. 소재 교체/타겟팅 정교화.' },
                    { media: '네이버 GFA', creative: '소재D_옐로우', cost: 800000, imp: 1800000, click: 4500, cpm: 444.4, ctr: 0.25, cpc: 177.8, scoreA: 2.0, scoreB: 1.5, total: 1.75, insight: 'Low 소재', color: '#ef4444', mediaInsight: 'Low 소재는 즉시 OFF 및 예산을 Top 소재로 이관해야 합니다.' },
                ],
            },
            'PERF': {
                name: '퍼포먼스 캠페인 (전환 목표)',
                metrics: { xAxis: '전환 기여도 (B)', yAxis: '광고 관심도 (A)' },
                summary: [
                    { label: '총 광고비', value: 6000000, type: 'currency' },
                    { label: '총 매출액', value: 30000000, type: 'currency' },
                    { label: '총 전환수', value: 250, type: 'number' },
                    { label: '평균 CPA', value: 24000, type: 'currency' },
                    { label: '평균 ROAS', value: 500, type: 'percent' },
                ],
                headers: [
                    '매체', '소재 구분', '노출수', '클릭수', '전환수', '매출액', '광고비', 'CTR(%)', 'CPA(원)', 'ROAS(%)', '광고 관심도(A)', '전환 기여도(B)', '총점', 'INSIGHT', '교체 유무'
                ],
                data: [
                    { media: '구글 SA', creative: '소재_키워드1', cost: 2000000, imp: 150000, click: 7500, conv: 100, revenue: 15000000, ctr: 5.0, cpa: 20000, roas: 750, scoreA: 5.0, scoreB: 4.8, total: 4.9, insight: 'Top 소재', color: '#10b981', mediaInsight: 'SA Top 키워드는 독보적인 효율입니다. 예산 최대 확대를 고려.' },
                    { media: '페이스북/인스타', creative: '소재_여성타겟', cost: 1800000, imp: 500000, click: 4000, conv: 80, revenue: 8000000, ctr: 0.8, cpa: 22500, roas: 444, scoreA: 4.0, scoreB: 4.5, total: 4.25, insight: 'Top 소재', color: '#10b981', mediaInsight: 'SNS는 관심도(A)는 우수하나, CPA 개선을 위해 랜딩페이지 최적화(LPO)가 필요합니다.' },
                    { media: '네이버 쇼핑검색', creative: '소재_상품A', cost: 1200000, imp: 200000, click: 1500, conv: 50, revenue: 5000000, ctr: 0.75, cpa: 24000, roas: 416, scoreA: 3.5, scoreB: 3.0, total: 3.25, insight: 'Potential 소재', color: '#3b82f6', mediaInsight: '쇼핑검색은 전환 볼륨(B)을 늘려야 합니다. 예산 증액보다는 소재(A) 개선 필요.' },
                    { media: '구글 GDN', creative: '소재_리타겟팅', cost: 1000000, imp: 400000, click: 500, conv: 20, revenue: 2000000, ctr: 0.125, cpa: 50000, roas: 200, scoreA: 1.5, scoreB: 1.0, total: 1.25, insight: 'Low 소재', color: '#ef4444', mediaInsight: 'Low 효율 리타겟팅 캠페인은 즉시 OFF하거나 타겟팅 세그먼트를 매우 좁게 재설정해야 합니다.' },
                ],
            }
        };

        let currentCampaign = 'DA';
        const matrixContainer = document.getElementById('quadrant-matrix');
        const tooltip = document.createElement('div');
        tooltip.id = 'chart-tooltip';
        tooltip.className = 'absolute p-2 bg-gray-800 text-white text-xs rounded-lg shadow-xl pointer-events-none opacity-0 transition-opacity duration-200 z-[100] whitespace-nowrap';
        document.body.appendChild(tooltip);


        // Number formatting function
        const formatNumber = (num, type) => {
            if (typeof num !== 'number') return num;
            switch (type) {
                case 'percent': return `${num.toFixed(2)}%`;
                case 'currency': return `${Math.round(num).toLocaleString('ko-KR')}원`;
                case 'score': return num.toFixed(2);
                default: return num.toLocaleString('ko-KR');
            }
        };

        // --- Chart & Visualization Logic ---
        function renderChart() {
            const data = campaignData[currentCampaign];
            const matrixRect = matrixContainer.getBoundingClientRect();
            const W = matrixRect.width;
            const H = matrixRect.height;

            matrixContainer.querySelectorAll('.chart-dot').forEach(dot => dot.remove());

            // Define min/max scores (0 to 5)
            const MIN_SCORE = 0;
            const MAX_SCORE = 5;
            const MID_SCORE = 2.5;

            // Padding inside the matrix container
            const PADDING = 25;
            const plotW = W - 2 * PADDING;
            const plotH = H - 2 * PADDING;

            // Scale Factor
            const scaleX = plotW / (MAX_SCORE - MIN_SCORE);
            const scaleY = plotH / (MAX_SCORE - MIN_SCORE);

            // Set Axis Labels
            document.getElementById('summary-title').textContent = `(${data.name.split('(')[1].replace(')', '')})`;
            document.getElementById('chart-axes-label').textContent = `Y축: ${data.metrics.yAxis} | X축: ${data.metrics.xAxis}`;
            document.getElementById('x-axis-label').textContent = data.metrics.xAxis;
            document.getElementById('y-high-label').textContent = data.metrics.yAxis + ' (높음)';
            document.getElementById('y-low-label').textContent = data.metrics.yAxis + ' (낮음)';


            // Draw Data Points (Dots - using DOM for tooltips)
            data.data.forEach((item, index) => {
                // Calculate position relative to the 0,0 point (top-left of plot area)
                // X (Score B) moves from Left (MIN) to Right (MAX)
                // Y (Score A) moves from Bottom (MIN) to Top (MAX) - requires inversion for CSS top property
                
                // X position: 
                let x = PADDING + (item.scoreB - MIN_SCORE) * scaleX; 
                // Y position: Inverted from bottom to top
                let y = H - PADDING - (item.scoreA - MIN_SCORE) * scaleY;

                // Create a DOM element for the dot
                const dot = document.createElement('div');
                dot.className = 'chart-dot';
                dot.style.backgroundColor = item.color;
                
                // Clamp coordinates to prevent dots from escaping the plot area edges
                const DOT_SIZE = 14;
                x = Math.max(PADDING + DOT_SIZE/2, Math.min(W - PADDING - DOT_SIZE/2, x));
                y = Math.max(PADDING + DOT_SIZE/2, Math.min(H - PADDING - DOT_SIZE/2, y));

                dot.style.left = `${x - DOT_SIZE / 2}px`; // Center dot
                dot.style.top = `${y - DOT_SIZE / 2}px`;  // Center dot
                
                dot.dataset.index = index;
                dot.dataset.campaign = currentCampaign;
                dot.dataset.creative = item.creative;
                dot.dataset.insight = item.insight;
                dot.dataset.scoreA = item.scoreA.toFixed(1);
                dot.dataset.scoreB = item.scoreB.toFixed(1);
                dot.dataset.total = item.total.toFixed(2);
                
                // Add event listeners for tooltips
                dot.addEventListener('mouseenter', showTooltip);
                dot.addEventListener('mousemove', moveTooltip);
                dot.addEventListener('mouseleave', hideTooltip);

                matrixContainer.appendChild(dot);
            });
        }
        
        // Tooltip Functions for position on mouse move
        function showTooltip(e) {
            const el = e.target;
            const data = campaignData[el.dataset.campaign];

            tooltip.innerHTML = `
                <div class="font-bold text-sm mb-1 text-center" style="color:${el.style.backgroundColor}">${el.dataset.insight}</div>
                <div class="text-xs font-semibold">${el.dataset.creative}</div>
                <div class="text-xs">A (${data.metrics.yAxis.split('(')[0]}): ${el.dataset.scoreA}점</div>
                <div class="text-xs">B (${data.metrics.xAxis.split('(')[0]}): ${el.dataset.scoreB}점</div>
                <div class="text-xs font-bold mt-1 border-t border-gray-700 pt-1">총점: ${el.dataset.total}점</div>
            `;
            tooltip.style.opacity = 1;
            moveTooltip(e); // Initial positioning
        }

        function moveTooltip(e) {
            // Position relative to the whole window
            const x = e.clientX + 15;
            let y = e.clientY + 15;
            
            // Boundary check: move up if near bottom edge
            if (y + tooltip.offsetHeight > window.innerHeight) {
                y = e.clientY - tooltip.offsetHeight - 15;
            }

            tooltip.style.left = `${x}px`;
            tooltip.style.top = `${y}px`;
        }

        function hideTooltip() {
            tooltip.style.opacity = 0;
        }

        // --- Summary Table Logic (NEW) ---
        function renderSummaryTable() {
            const data = campaignData[currentCampaign];
            const headerRow = document.getElementById('summary-header');
            const body = document.getElementById('summary-body');
            headerRow.innerHTML = '';
            body.innerHTML = '';

            // Render Header
            data.summary.forEach(metric => {
                const th = document.createElement('th');
                th.className = 'px-6 py-3 text-center';
                th.textContent = metric.label;
                headerRow.appendChild(th);
            });

            // Render Body (Single Row)
            const tr = document.createElement('tr');
            tr.className = 'text-gray-900';
            data.summary.forEach(metric => {
                const td = document.createElement('td');
                td.className = 'px-6 py-4 whitespace-nowrap text-center text-lg font-bold';
                td.textContent = metric.type === 'percent' 
                    ? formatNumber(metric.value, metric.type) 
                    : formatNumber(metric.value, metric.type);
                tr.appendChild(td);
            });
            body.appendChild(tr);
        }

        // --- Detailed Table & Insight Rendering Logic ---
        function renderTable() {
            const data = campaignData[currentCampaign];
            const headerRow = document.getElementById('table-header');
            const body = document.getElementById('table-body');
            headerRow.innerHTML = '';
            body.innerHTML = '';

            // Render Header
            data.headers.forEach(header => {
                const th = document.createElement('th');
                th.className = 'px-4 py-3 text-left border-b border-gray-200';
                th.textContent = header;
                headerRow.appendChild(th);
            });

            // Render Body
            data.data.forEach(item => {
                const tr = document.createElement('tr');
                tr.className = 'hover:bg-indigo-50 transition-colors';
                
                const getCellValue = (key) => {
                    const value = item[key];
                    // Mapping keys to types for formatting
                    const formatMap = {
                        'cost': 'currency', 'revenue': 'currency', 'cpa': 'currency', 'cpc': 'currency', 'cpm': 'currency',
                        'roas': 'percent',
                        'ctr': 'percent',
                        'scoreA': 'score', 'scoreB': 'score', 'total': 'score',
                        'imp': 'number', 'click': 'number', 'conv': 'number'
                    };

                    if (formatMap[key]) {
                        // CTR and ROAS need pre-multiplication by 100 if they are stored as decimals
                        let displayValue = value;
                        if (key === 'ctr' && typeof value === 'number') displayValue = value * 100;
                        
                        return formatNumber(displayValue, formatMap[key]);
                    }
                    if (key === 'insight') return `<span class="px-3 py-1 inline-flex text-xs leading-5 font-semibold rounded-full" style="background-color:${item.color}1A; color:${item.color}">${value}</span>`;
                    if (key === 'media' || key === 'creative') return `<span class="font-medium text-gray-900">${value}</span>`;
                    return value;
                };

                // Define the order of keys for the table row
                const keys = currentCampaign === 'DA' 
                    ? ['media', 'creative', 'imp', 'click', 'cost', 'cpm', 'ctr', 'cpc', 'scoreA', 'scoreB', 'total', 'insight', '교체 유무']
                    : ['media', 'creative', 'imp', 'click', 'conv', 'revenue', 'cost', 'ctr', 'cpa', 'roas', 'scoreA', 'scoreB', 'total', 'insight', '교체 유무'];
                
                keys.forEach(key => {
                    const td = document.createElement('td');
                    td.className = 'px-4 py-3 whitespace-nowrap text-sm text-gray-600';
                    if(key === '교체 유무') {
                        // Insight-based action
                        td.innerHTML = item.total < 2.0 ? '<span class="text-red-600 font-bold bg-red-100 rounded-lg px-2 py-1">OFF/교체</span>' : '<span class="text-green-600 bg-green-100 rounded-lg px-2 py-1">유지/확대</span>';
                    } else {
                        td.innerHTML = getCellValue(key);
                    }
                    tr.appendChild(td);
                });

                body.appendChild(tr);
            });
        }

        function renderInsights() {
            const data = campaignData[currentCampaign];
            const insightList = document.getElementById('insight-list');
            insightList.innerHTML = '';

            // Grouping insights by performance grade for better structure
            const gradeInsights = {
                'Top 소재': [],
                'Potential 소재': [],
                'Focus 소재': [],
                'Low 소재': [],
            };

            data.data.forEach(item => {
                gradeInsights[item.insight]?.push({ 
                    media: item.media, 
                    insight: item.mediaInsight,
                    color: item.color
                });
            });

            // Display Insights in structured list
            Object.entries(gradeInsights).forEach(([grade, items]) => {
                if (items.length > 0) {
                    const gradeColor = items[0].color;
                    const gradeHeader = document.createElement('li');
                    gradeHeader.className = 'pt-2 mb-2 font-extrabold text-base border-b-2 pb-1';
                    gradeHeader.style.borderColor = gradeColor;
                    gradeHeader.style.color = gradeColor;
                    gradeHeader.textContent = `[${grade}] 핵심 전략 (${items.length}개 소재)`;
                    insightList.appendChild(gradeHeader);

                    items.forEach(item => {
                        const li = document.createElement('li');
                        li.className = 'text-gray-700 text-sm flex items-start';
                        li.innerHTML = `
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 mt-1 mr-2 flex-shrink-0" style="color:${gradeColor}" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-8.707a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clip-rule="evenodd"/></svg>
                            <span class="font-semibold text-gray-900">${item.media}:</span> <span>${item.insight}</span>
                        `;
                        insightList.appendChild(li);
                    });
                }
            });
        }


        function renderDashboard() {
            // Update Tab State
            document.querySelectorAll('.campaign-tab').forEach(tab => {
                if (tab.dataset.camp === currentCampaign) {
                    tab.classList.replace('text-gray-600', 'text-white');
                    tab.classList.add('bg-indigo-600', 'shadow-lg');
                    tab.classList.remove('hover:bg-white', 'hover:text-indigo-600');
                } else {
                    tab.classList.replace('text-white', 'text-gray-600');
                    tab.classList.remove('bg-indigo-600', 'shadow-lg');
                    tab.classList.add('hover:bg-white', 'hover:text-indigo-600');
                }
            });

            renderSummaryTable();
            renderTable();
            renderChart();
            renderInsights();
        }

        // --- Event Listeners and Initialization ---
        document.addEventListener('DOMContentLoaded', () => {
            document.querySelectorAll('.campaign-tab').forEach(tab => {
                tab.addEventListener('click', (e) => {
                    currentCampaign = e.target.dataset.camp;
                    renderDashboard();
                });
            });

            // Initial render
            renderDashboard();

            // Handle window resize for chart responsiveness
            window.addEventListener('resize', renderChart);
        });
    </script>
</body>
</html>
